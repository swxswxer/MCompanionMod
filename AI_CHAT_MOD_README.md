# MCompanion AI聊天Mod 使用说明

## 功能介绍

这是一个为Minecraft 1.20.1 Forge 47.4.0开发的AI聊天mod，主要功能包括：

1. **按键快捷键**: 默认按 `-` 键打开AI聊天窗口
2. **ChatGPT风格界面**: 
   - 左侧聊天历史列表，支持多个对话会话
   - 右侧聊天内容区域，用户消息右对齐，AI消息左对齐
   - 底部输入框，支持Enter快速发送
3. **流式显示**: 支持SSE流式响应，实时显示AI回复
4. **多会话管理**: 支持创建多个聊天会话，每个会话独立记录对话历史
5. **设置管理**: 可配置API Key等参数

## 使用步骤

### 1. 首次设置
- 启动游戏后，按 `-` 键打开AI聊天窗口
- 点击左上角的 ⚙ 设置按钮
- 输入你的API Key并保存

### 2. 开始聊天
- 在聊天窗口底部的输入框中输入你的问题
- 点击"发送"按钮或按Enter键发送消息
- AI会实时流式回复你的问题

### 3. 界面操作
- **新建对话**: 点击左侧"+ 新对话"按钮创建新的聊天会话
- **切换对话**: 点击左侧历史对话列表切换不同的聊天会话
- **滚动查看**: 在聊天区域使用鼠标滚轮查看历史消息
- **关闭窗口**: 按ESC键关闭聊天窗口
- **设置修改**: 点击右上角⚙按钮修改API Key

## 后端要求

确保你的后端服务正在运行：
- 默认地址: `http://localhost:8123/api`
- 聊天接口: `/ai/chat`
- 支持SSE流式响应
- 需要在请求头中包含 `X-API-Key`

## 按键绑定

可以在游戏的"选项" -> "控制" -> "按键绑定"中找到"AI伙伴"分类，自定义打开聊天窗口的按键。

## 配置文件

配置文件保存在: `<游戏目录>/config/mcompanion_client.json`

## 故障排除

1. **无法连接服务器**: 检查后端服务是否启动，确认地址和端口正确
2. **API Key错误**: 在设置中重新输入正确的API Key
3. **聊天无响应**: 检查网络连接和后端日志

## 开发信息

- **Mod ID**: mcompanion
- **版本**: 1.0.0
- **Minecraft版本**: 1.20.1
- **Forge版本**: 47.4.0
- **依赖库**: 无外部依赖，使用Java内置HTTP客户端和Minecraft自带的Gson

## 更新日志

### v1.0.0
- ✅ 修复了OkHttp依赖导致的游戏崩溃问题
- ✅ 改用Java内置HTTP客户端，无需外部依赖
- ✅ 重新设计了ChatGPT风格的现代化界面
- ✅ 新增多会话管理功能，支持历史对话切换
- ✅ 修复了输入框无法输入和输入法识别问题
- ✅ 优化了文字显示效果，添加阴影减少模糊
- ✅ 调整了界面布局比例，侧边栏与聊天区域约1:5
- ✅ 保持了SSE流式响应和实时显示效果
- ✅ 优化了消息显示样式，用户消息和AI消息区分明显
- ✅ 改进了焦点管理，确保输入框能正确接收键盘输入 